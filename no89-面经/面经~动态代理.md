动态代理

为其他对象提供一种代理以控制对这个对象的访问,在某种情况下,一个对象不适合或者不能直接引用另一个对象,而代理对象可以在两者之间起到中介的作用.所谓动态代理,就是实现阶段不用关心代理谁,而是在运行阶段才指定代理那个对象,如果是自己写代理类的方法就是静态代理(确定性).

组成要素:

(动态)代理模式主要涉及三个要素:

1:抽象类接口

2:被代理类(具体实现抽象接口的类)

3:动态代理类:实际调用被代理类的方法和属性的类

实现方法:

实现动态代理的方法有很多,比如JDK自身提供的动态代理,就是主要利用了反射机制,还有其他的实现方式,比如利用字节码操作机制,类似ASM,CGLIB(基于ASM),Javassist等.

举例:常常采用JDK提供的动态代理接口InvocationHandler来实现动态代理类.





在java的动态代理机制中，有两个重要的类或接口，一个是 InvocationHandler(Interface)、另一个则是 Proxy(Class)，这一个类和接口是实现我们动态代理所必须用到的。


每一个动态代理类都必须要实现InvocationHandler这个接口，并且每个代理类的实例都关联到了一个handler，当我们通过代理对象调用一个方法的时候，这个方法的调用就会被转发为由InvocationHandler这个接口的 invoke 方法来进行调用。我们来看看InvocationHandler这个接口的唯一一个方法 invoke 方法：


我们看到这个方法一共接受三个参数，那么这三个参数分别代表什么呢？

Object invoke(Object proxy, Method method, Object[] args) throws Throwable
 
proxy:  指代我们所代理的那个真实对象
 
method:  指代的是我们所要调用真实对象的某个方法的Method对象
 
args:  指代的是调用真实对象某个方法时接受的参数